### BMI vs Catch Rate

Our goal now is to investigate how height and weight (BMI) of a pokemon correlate to its capture rate. 

We will assess this correlation by fitting a linear regression model that will plot BMI vs Capture rate. BMI (body mass index) will be calculated as kg/m^2. We will start by plotting the graph of BMI vs capture rate using the ggplot() function. 

Setup: 
```{r setup}
library(tidyr)
library(dplyr)
library(rvest)
library(tidyverse)
library(broom)
knitr::opts_chunk$set(echo = TRUE)
```

```{r bmi}
pokedex <- pokedex.table
pokedex %>% ggplot(aes(x=as.numeric(BMI), y=Catch_rate)) + geom_point() + geom_smooth(method=lm) + 
  labs(title="BMI vs. Capture Rate", x="BMI", y = "Captue Rate")

```
As can be seen by the above plot, there really does not seem to be a strong interaction between either two variables (BMI vs Catch rate). It is hard to distinguish any linear trend amongst the data set, hence the almost horizontal line of best-fit generated by the above image. 

Let us still see what we get for the equation after generating a linear regression model. 


```{r equa}
auto_fit1 <- lm(Catch_rate ~ as.numeric(BMI), data=pokedex.table)
auto_fit1
```
The linear regression equation generated is y = 98.88 - 0.047(x). Where, once again, x represents the BMI of the pokemon (our explanatory variable) and y is the catch rate of the pokemon, (our response variable). 

Now we will be plotting the 95% confidence interval. 
```{r}
auto_fit_stats2 <- auto_fit1 %>% tidy() %>% select(term, estimate, std.error)
auto_fit_stats2
  
```

Now we will be plotting the 95% confidence interval. 



```{r confidence_interval }
confidence_interval_offset <- 1.95 * auto_fit_stats2$std.error[2]
confidence_interval <- round(c(auto_fit_stats2$estimate[2] - confidence_interval_offset, auto_fit_stats2$estimate[2],
auto_fit_stats2$estimate[2] + 
confidence_interval_offset), 4)
confidence_interval


```
Given the confidence interval, we would conclude that, on average for each k/m^2, we can have 95% confidence that the catch rate will lie within (-0.0768, 0.1705) interval.  

